function [M,Mp] = dmc_predmat(ny,nu,D)

% Ks=195;Ts=0.86;T0=0.01;
% G = tf(Ks,[Ts 1],"inputdelay",0);
% Gd = c2d(G,T0);
% opt = stepDataOptions('StepAmplitude',1);
% [y,~] = step(Gd,0:T0:T0*500,opt);
% S = y(2:end);
% S = S';

% ================== T0 = 0.01 ==================
S = [2.25431000689019	4.48255891835901	6.68504801537160	8.86207509591515	11.0139345152641	13.1409172257800	15.2433108162507	17.3213995507757	19.3754644072010	21.4057831151102	23.4126301933762	25.3962769872790	27.3569917051939	29.2950394548562	31.2106822792063	33.1041791918201	34.9757862119308	36.8257563990445	38.6543398871569	40.4617839185735	42.2483328773393	44.0142283222817	45.7597090196720	47.4850109755087	49.1903674674277	50.8760090762439	52.5421637171279	54.1890566704223	55.8169106121018	57.4259456438815	59.0163793229761	60.5884266915165	62.1423003056250	63.6782102641555	65.1963642371003	66.6969674936697	68.1802229300460	69.6463310968172	71.0954902260933	72.5278962583094	73.9437428687185	75.3432214935786	76.7265213560364	78.0938294917123	79.4453307739894	80.7812079390103	82.1016416103847	83.4068103236113	84.6968905502178	85.9720567216216	87.2324812527145	88.4783345651746	89.7097851105097	90.9269993928327	92.1301419913754	93.3193755827406	94.4948609628979	95.6567570689247	96.8052210004962	97.9404080411267	99.0624716791655	100.171563628550	101.267833849319	102.351430567888	103.422500297092	104.481187855996	105.527636389473	106.561987387562	107.584380704596	108.594954578115	109.593845647553	110.581188972715	111.557118052041	112.521764840652	113.475259768192	114.417731756468	115.349308236874	116.270115167630	117.180277050804	118.079916949151	118.969156502753	119.848115945462	120.716914121158	121.575668499821	122.424495193411	123.263508971568	124.092823277130	124.912550241472	125.722800699668	126.523684205473	127.315309046143	128.097782257069	128.871209636253	129.635695758615	130.391343990127	131.138256501792	131.876534283461	132.606277157484	133.327583792207	134.040551715316	134.745277327022	135.441855913094	136.130381657745	136.810947656365	137.483645928107	138.148567428333	138.805802060909	139.455438690362	140.097565153893	140.732268273258	141.359633866504	141.979746759570	142.592690797764	143.198548857091	143.797402855465	144.389333763781	144.974421616867	145.552745524301	146.124383681110	146.689413378344	147.247911013523	147.799952100970	148.345611282018	148.884962335107	149.418078185754	149.945030916416	150.465891776238	150.980731190683	151.489618771056	151.992623323918	152.489812860384	152.981254605326	153.467015006455	153.947159743311	154.421753736142	154.890861154678	155.354545426816	155.812869247185	156.265894585633	156.713682695600	157.156294122402	157.593788711415	158.026225616173	158.453663306357	158.876159575709	159.293771549842	159.706555693962	160.114567820509	160.517863096699	160.916496051981	161.310520585416	161.699989972961	162.084956874671	162.465473341823	162.841590823951	163.213360175804	163.580831664220	163.944054974925	164.303079219251	164.657952940772	165.008724121876	165.355440190242	165.698148025263	166.036893964376	166.371723809333	166.702682832393	167.029815782440	167.353166891036	167.672779878402	167.988697959328	168.300963849017	168.609619768861	168.914707452146	169.216268149702	169.514342635471	169.808971212030	170.100193716033	170.388049523600	170.672577555642	170.953816283119	171.231803732250	171.506577489646	171.778174707395	172.046632108090	172.311985989785	172.574272230911	172.833526295125	173.089783236101	173.343077702276	173.593443941528	173.840915805813	174.085526755739	174.327309865090	174.566297825298	174.802522949863	175.036017178725	175.266812082578	175.494938867143	175.720428377383	175.943311101677	176.163617175942	176.381376387706	176.596618180135	176.809371656018	177.019665581697	177.227528390961	177.432988188886	177.636072755640	177.836809550234	178.035225714239	178.231348075455	178.425203151535	178.616817153574	178.806215989653	178.993425268340	179.178470302153	179.361376110985	179.542167425482	179.720868690393	179.897504067869	180.072097440735	180.244672415716	180.415252326629	180.583860237542	180.750518945887	180.915250985545	181.078078629893	181.239023894815	181.398108541679	181.555354080280	181.710781771746	181.864412631416	182.016267431680	182.166366704785	182.314730745617	182.461379614438	182.606333139606	182.749610920250	182.891232328920	183.031216514213	183.169582403353	183.306348704757	183.441533910562	183.575156299125	183.707233937494	183.837784683854	183.966826189937	184.094375903413	184.220451070246	184.345068737026	184.468245753276	184.589998773730	184.710344260582	184.829298485714	184.946877532898	185.063097299965	185.177973500961	185.291521668267	185.403757154702	185.514695135598	185.624350610851	185.732738406948	185.839873178977	185.945769412603	186.050441426028	186.153903371928	186.256169239367	186.357252855686	186.457167888376	186.555927846922	186.653546084632	186.750035800445	186.845410040709	186.939681700952	187.032863527620	187.124968119804	187.216007930943	187.305995270507	187.394942305659	187.482861062907	187.569763429723	187.655661156153	187.740565856408	187.824489010430	187.907441965447	187.989435937507	188.070482012995	188.150591150128	188.229774180444	188.308041810259	188.385404622119	188.461873076232	188.537457511876	188.612168148803	188.686015088621	188.759008316155	188.831157700800	188.902472997857	188.972963849847	189.042639787823	189.111510232648	189.179584496279	189.246871783019	189.313381190765	189.379121712237	189.444102236194	189.508331548636	189.571818333992	189.634571176294	189.696598560338	189.757908872830	189.818510403523	189.878411346332	189.937619800451	189.996143771438	190.053991172306	190.111169824585	190.167687459387	190.223551718447	190.278770155157	190.333350235588	190.387299339499	190.440624761334	190.493333711209	190.545433315889	190.596930619747	190.647832585721	190.698146096253	190.747877954219	190.797034883851	190.845623531646	190.893650467261	190.941122184407	190.988045101722	191.034425563642	191.080269841257	191.125584133160	191.170374566286	191.214647196737	191.258408010603	191.301662924775	191.344417787736	191.386678380362	191.428450416697	191.469739544727	191.510551347143	191.550891342101	191.590764983959	191.630177664023	191.669134711271	191.707641393076	191.745702915917	191.783324426081	191.820511010364	191.857267696755	191.893599455114	191.929511197852	191.965007780584	192.000094002794	192.034774608483	192.069054286805	192.102937672707	192.136429347553	192.169533839744	192.202255625330	192.234599128614	192.266568722755	192.298168730352	192.329403424035	192.360277027038	192.390793713773	192.420957610394	192.450772795353	192.480243299955	192.509373108897	192.538166160816	192.566626348810	192.594757520976	192.622563480922	192.650047988285	192.677214759237	192.704067466992	192.730609742296	192.756845173924	192.782777309162	192.808409654288	192.833745675043	192.858788797106	192.883542406550	192.908009850304	192.932194436605	192.956099435446	192.979728079014	193.003083562132	193.026169042690	193.048987642070	193.071542445567	193.093836502812	193.115872828179	193.137654401193	193.159184166935	193.180465036439	193.201499887086	193.222291562994	193.242842875398	193.263156603038	193.283235492526	193.303082258724	193.322699585109	193.342090124134	193.361256497588	193.380201296954	193.398927083751	193.417436389888	193.435731718005	193.453815541808	193.471690306406	193.489358428642	193.506822297417	193.524084274017	193.541146692429	193.558011859659	193.574682056042	193.591159535550	193.607446526099	193.623545229849	193.639457823503	193.655186458596	193.670733261795	193.686100335179	193.701289756525	193.716303579591	193.731143834393	193.745812527477	193.760311642194	193.774643138965	193.788808955549	193.802811007302	193.816651187437	193.830331367282	193.843853396531	193.857219103493	193.870430295343	193.883488758362	193.896396258181	193.909154540021	193.921765328926	193.934230329997	193.946551228623	193.958729690711	193.970767362906	193.982665872820	193.994426829247	194.006051822383	194.017542424040	194.028900187859	194.040126649522	194.051223326954	194.062191720536	194.073033313300	194.083749571135	194.094341942984	194.104811861039	194.115160740935	194.125389981941	194.135500967151	194.145495063667	194.155373622790	194.165137980196	194.174789456122	194.184329355542	194.193758968343	194.203079569500	194.212292419249	194.221398763259	194.230399832794	194.239296844887	194.248091002502	194.256783494693	194.265375496771	194.273868170458	194.282262664046	194.290560112553	194.298761637873	194.306868348935	194.314881341843	194.322801700033	194.330630494414	194.338368783515	194.346017613629	194.353578018951	194.361051021723	194.368437632368	194.375738849626	194.382955660693	194.390089041354	194.397139956110	194.404109358313	194.410998190296	194.417807383494	194.424537858578	194.431190525573	194.437766283984	194.444266022919	194.450690621204	194.457040947509	194.463317860460	194.469522208756	194.475654831285	194.481716557238	194.487708206220	194.493630588359	194.499484504420	194.505270745909	194.510990095182	194.516643325550	194.522231201387	194.527754478226	194.533213902870	194.538610213484	194.543944139704	194.549216402727	194.554427715416	194.559578782390	194.564670300124	194.569702957040	194.574677433604	194.579594402412	194.584454528287	194.589258468365	194.594006872185	194.598700381779	194.603339631754	194.607925249382	194.612457854683	194.616938060510	194.621366472631	194.625743689808	194.630070303886	194.634346899865	194.638574055981	194.642752343788	194.646882328231	194.650964567724	194.654999614225	194.658988013312	194.662930304256	194.666827020093	194.670678687696	194.674485827849	194.678248955314	194.681968578902	194.685645201544	194.689279320353	194.692871426699	194.696422006270	194.699931539137	194.703400499825	194.706829357370	194.710218575387	194.713568612132	194.716879920563	194.720152948400	194.723388138189	194.726585927359	194.729746748282	194.732871028332	194.735959189942	194.739011650661	194.742028823213	194.745011115548	194.747958930901	194.750872667846	194.753752720348	194.756599477818	194.759413325166	194.762194642851	194.764943806935	194.767661189131	194.770347156855	194.773002073278	194.775626297369	194.778220183949	194.780784083737	194.783318343397	194.785823305586	194.788299308998	194.790746688415	194.793165774744	194.795556895071	194.797920372699	194.800256527191	194.802565674419	194.804848126603	194.807104192352	194.809334176709	194.811538381188	194.813717103819	194.815870639189	194.817999278474	194.820103309488	194.822183016717	194.824238681357	194.826270581354	194.828278991441	194.830264183174	194.832226424971	194.834165982146	194.836083116946	194.837978088586	194.839851153284	194.841702564298	194.843532571957	194.845341423694	194.847129364085	194.848896634876	194.850643475020	194.852370120707	194.854076805395	194.855763759845	194.857431212151	194.859079387767	194.860708509543	194.862318797752	194.863910470121	194.865483741860	194.867038825690	194.868575931873	194.870095268242	194.871597040225	194.873081450877	194.874548700905	194.875998988694	194.877432510338	194.878849459664	194.880250028256	194.881634405485	194.883002778532	194.884355332415	194.885692250011	194.887013712087	194.888319897315	194.889610982305	194.890887141624	194.892148547821	194.893395371452	194.894627781097	194.895845943392	194.897050023044	194.898240182856	194.899416583748	194.900579384783	194.901728743182	194.902864814349	194.903987751893	194.905097707645	194.906194831683	194.907279272348	194.908351176267	194.909410688372	194.910457951919	194.911493108509	194.912516298105	194.913527659051	194.914527328095	194.915515440401	194.916492129571	194.917457527663	194.918411765208	194.919354971230	194.920287273257	194.921208797347	194.922119668099	194.923020008671	194.923909940798	194.924789584808	194.925659059636	194.926518482846	194.927367970638	194.928207637872	194.929037598079	194.929857963477	194.930668844989	194.931470352254	194.932262593642	194.933045676272	194.933819706026	194.934584787559	194.935341024318	194.936088518554	194.936827371334	194.937557682560	194.938279550975	194.938993074185	194.939698348664	194.940395469772	194.941084531766	194.941765627815	194.942438850010	194.943104289376	194.943762035888	194.944412178479	194.945054805055	194.945690002506	194.946317856715	194.946938452576	194.947551873998	194.948158203922	194.948757524331	194.949349916257	194.949935459799	194.950514234127	194.951086317497	194.951651787261	194.952210719876	194.952763190914	194.953309275075	194.953849046195	194.954382577256	194.954909940398	194.955431206924	194.955946447315	194.956455731236	194.956959127548	194.957456704315	194.957948528813	194.958434667543	194.958915186234	194.959390149859	194.959859622636	194.960323668043	194.960782348824	194.961235726995	194.961683863860	194.962126820009	194.962564655335	194.962997429039	194.963425199633	194.963848024959	194.964265962185	194.964679067821	194.965087397723	194.965491007101	194.965889950527	194.966284281941	194.966674054662	194.967059321391	194.967440134219	194.967816544635	194.968188603535	194.968556361224	194.968919867427	194.969279171293	194.969634321404	194.969985365779	194.970332351883	194.970675326632	194.971014336399	194.971349427022	194.971680643809	194.972008031542	194.972331634489	194.972651496403	194.972967660533	194.973280169627	194.973589065940	194.973894391237	194.974196186802	194.974494493439	194.974789351484	194.975080800803	194.975368880803	194.975653630437	194.975935088203	194.976213292160	194.976488279921	194.976760088669	194.977028755155	194.977294315704	194.977556806224	194.977816262205	194.978072718729	194.978326210470	194.978576771704	194.978824436309	194.979069237771	194.979311209190	194.979550383283	194.979786792389	194.980020468472	194.980251443128	194.980479747586	194.980705412716	194.980928469030	194.981148946687	194.981366875498	194.981582284929	194.981795204105	194.982005661816	194.982213686516	194.982419306334	194.982622549071	194.982823442207	194.983022012905	194.983218288014	194.983412294071	194.983604057310	194.983793603657	194.983980958741	194.984166147895	194.984349196158	194.984530128279	194.984708968724	194.984885741671	194.985060471024	194.985233180407	194.985403893172	194.985572632401	194.985739420910	194.985904281249	194.986067235710	194.986228306325	194.986387514873	194.986544882880	194.986700431625	194.986854182138	194.987006155209	194.987156371385	194.987304850977	194.987451614062	194.987596680482	194.987740069853	194.987881801562	194.988021894772	194.988160368426	194.988297241246	194.988432531739	194.988566258198	194.988698438703	194.988829091127	194.988958233136	194.989085882190	194.989212055549	194.989336770273	194.989460043224	194.989581891070	194.989702330287	194.989821377158	194.989939047780	194.990055358064	194.990170323734	194.990283960337	194.990396283237	194.990507307621	194.990617048500	194.990725520712	194.990832738925	194.990938717635	194.991043471171	194.991147013697	194.991249359213	194.991350521557	194.991450514407	194.991549351284	194.991647045550	194.991743610416	194.991839058937	194.991933404020	194.992026658420	194.992118834747	194.992209945463	194.992300002888	194.992389019199	194.992477006430	194.992563976480	194.992649941107	194.992734911934	194.992818900451	194.992901918013	194.992983975845	194.993065085042	194.993145256571	194.993224501272	194.993302829860	194.993380252925	194.993456780935	194.993532424239	194.993607193063	194.993681097518	194.993754147595	194.993826353173	194.993897724013	194.993968269766	194.994037999970	194.994106924054	194.994175051336	194.994242391029	194.994308952237	194.994374743959	194.994439775093	194.994504054429	194.994567590661	194.994630392377	194.994692468071	194.994753826134	194.994814474863	194.994874422459	194.994933677027	194.994992246579	194.995050139033	194.995107362219	194.995163923871	194.995219831640	194.995275093083	194.995329715672	194.995383706794	194.995437073747	194.995489823749	194.995541963931	194.995593501343	194.995644442953	194.995694795650	194.995744566241	194.995793761456	194.995842387946	194.995890452287	194.995937960977	194.995984920439	194.996031337024	194.996077217007	194.996122566591	194.996167391909	194.996211699021	194.996255493917	194.996298782520	194.996341570682	194.996383864189	194.996425668759	194.996466990044	194.996507833632	194.996548205046	194.996588109743	194.996627553119	194.996666540507	194.996705077180	194.996743168346	194.996780819157	194.996818034704	194.996854820018	194.996891180073	194.996927119785	194.996962644014	194.996997757563	194.997032465179	194.997066771555	194.997100681331	194.997134199090	194.997167329366	194.997200076636	194.997232445330	194.997264439823	194.997296064442	194.997327323462	194.997358221111	194.997388761565	194.997418948955	194.997448787361	194.997478280818	194.997507433315	194.997536248792	194.997564731145	194.997592884227	194.997620711844	194.997648217757	194.997675405686	194.997702279308	194.997728842255	194.997755098120	194.997781050452	194.997806702761	194.997832058514	194.997857121141	194.997881894030	194.997906380529	194.997930583952	194.997954507569	194.997978154615	194.998001528288	194.998024631749	194.998047468120	194.998070040490	194.998092351911	194.998114405399	194.998136203936	194.998157750470	194.998179047914	194.998200099147	194.998220907017	194.998241474335	194.998261803884];

% ================== T0 = 0.1 ==================
% S = [21.4057831151102	40.4617839185735	57.4259456438815	72.5278962583095	85.9720567216218	97.9404080411269	108.594954578115	118.079916949152	126.523684205473	134.040551715317	140.732268273259	146.689413378344	151.992623323918	156.713682695600	160.916496051981	164.657952940772	167.988697959328	170.953816283119	173.593443941528	175.943311101677	178.035225714239	179.897504067869	181.555354080279	183.031216514213	184.345068737025	185.514695135598	186.555927846921	187.482861062907	188.308041810258	189.042639787822	189.696598560338	190.278770155157	190.797034883851	191.258408010603	191.669134711271	192.034774608482	192.360277027037	192.650047988285	192.908009850304	193.137654401192	193.342090124133	193.524084274016	193.686100335178	193.830331367282	193.958729690710	194.073033313299	194.174789456122	194.265375496771	194.346017613628	194.417807383494	194.481716557238	194.538610213484	194.589258468364	194.634346899865	194.674485827849	194.710218575387	194.742028823213	194.770347156855	194.795556895071	194.817999278474	194.837978088585	194.855763759845	194.871597040225	194.885692250011	194.898240182855	194.909410688371	194.919354971229	194.928207637871	194.936088518553	194.943104289376	194.949349916257	194.954909940397	194.959859622636	194.964265962185	194.968188603535	194.971680643808	194.974789351483	194.977556806223	194.980020468472	194.982213686516	194.984166147895	194.985904281249	194.987451614061	194.988829091127	194.990055358063	194.991147013696	194.992118834746	194.992983975844	194.993754147595	194.994439775092	194.995050139033	194.995593501342	194.996077217007	194.996507833632	194.996891180073	194.997232445330	194.997536248791	194.997806702761	194.998047468120	194.998261803884];

% ================== T0 = 1 ==================
% S = [134.040551715317	175.943311101677	189.042639787822	193.137654401193	194.417807383494	194.817999278474	194.943104289376	194.982213686516	194.994439775092	194.998261803884];

Sn = S(1:ny);

M1 = zeros(ny,ny);
for k1 = 1:ny
    for w1 = 1:k1
        M1(k1,w1) = Sn(k1 - w1 + 1);
    end
end

M = M1(:,1:nu);

Mp = zeros(ny,D-1);

for k = 1:D-1
    for w = 1:ny

    Mp(w,k) = S(w+k) - S(k);

    end
end


